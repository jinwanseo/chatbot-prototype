doctype html
html
    head
        title RiveScript ì±„íŒ… í…ŒìŠ¤íŠ¸
        script(src="https://cdn.tailwindcss.com")
    body.flex.flex-col.w-screen.h-screen.items-center.bg-slate-900
        section.shadow.shadow-lg.p-6.flex.flex-col.items-center.justify-center.h-screen.w-full.gap-2
            h1.text-slate-300 ChatBot DEMO ðŸŽ‰
            div.flex.flex-row.justify-start.w-full.gap-2
                a.a.bg-sky-900.text-sky-50.text-xs.px-2.rounded(href=`/chat?chatId=1`) ëŒ€í™” í•˜ê¸°
                a.bg-teal-900.text-teal-50.text-xs.px-2.rounded(href=`/custom`) ëŒ€í™” ì„¤ì •
                a.bg-amber-900.text-amber-50.text-xs.px-2.rounded(href=`/topic`) ì£¼ì œ ì„¤ì •
                span.text-slate-300.text-xs.ml-auto ë‚´ê°€ ë§Œë“  ì±—ë´‡ê³¼ ëŒ€í™”í•  ìˆ˜ ìžˆì–´ìš”
            ul#messages.h-full.w-full.flex.flex-col.gap-5.bg-slate-800.text-sm.rounded.p-5.overflow-y-auto
            form(action="" onsubmit="sendMessage(event)" class="flex flex-row gap-2 w-full")
                input.bg-slate-800.border.border-slate-400.rounded.rounded-lg.w-full.text-slate-300.px-3.p-2(placeholder="ë©”ì‹œì§€ë¥¼ ìž…ë ¥í•´ì¤˜ìš”", type="text", id="messageText", autocomplete="off")
                button.bg-sky-900.text-sky-50.p-3.text-xs.rounded.m-1 ì „ì†¡
        script.
            const baseURL = window.location.origin;

            const urlParams = new URL(location.href).searchParams;
            const chatId = urlParams.get('chatId');

            // Response Message
            function responseMessage(message) {
                const messagesElement = document.getElementById('messages')
                const messageElement = document.createElement('li')
                messageElement.classList.add('bg-teal-800', 'rounded', 'p-2', 'mr-auto', 'text-teal-50')

                messagesElement.appendChild(messageElement);
                messageElement.innerHTML = "ðŸ¤– " + message;
                messagesElement.scrollTo(0, messagesElement.scrollHeight);
            };

            // Message Add (UI)
            function addMessage(content) {
                const messagesElement = document.getElementById('messages')
                const messageElement = document.createElement('li')
                messageElement.classList.add('bg-sky-800', 'rounded', 'p-2', 'ml-auto', 'text-sky-50')
                messagesElement.appendChild(messageElement)
                messageElement.innerHTML = content + " ðŸ§‘ðŸ»â€"
                messagesElement.scrollTo(0, messagesElement.scrollHeight);
            }

            // Send Message
            function sendMessage(event) {
                const inputElement = document.getElementById("messageText")
                // input value ì—†ì„ì‹œ ë¦¬í„´
                if (inputElement.value === '') return;
                // ë©”ì‹œì§€ ì¶”ê°€
                addMessage(inputElement.value);
                fetch(`${baseURL}/chat?chatId=` + chatId, {
                    headers: {'Content-Type': 'application/json'},
                    method: 'POST',
                    body: JSON.stringify({question: inputElement.value, use_nlp: false})
                })
                    .then(response => response.json())
                    .then(data => responseMessage(data.result))
                    .catch(error => console.log(error))

                if (inputElement.value === '') return;
                inputElement.value = ''
                event.preventDefault()
            }
